# Security Camera
### Set up the Raspberry Pi Zero Security Camera Script

You can, technically, do this next step from the Raspberry Pi Zero if you have an internet connection. The 3G modem will work wonders here, if already assembled.

1. Download the Node.js application from the repository: **[security-camera.js](../pi/security-camera.js)**, **[package.json](../pi/package.json)**. (An alternative is to download the files to a USB Flash Drive and transfer them to the Pi.)
2. Then, **copy our package** (security-camera.js, package.js) onto the Pi. We added it to the "camera" directory located at /home/pi/camera/.
3. To run the application, you will need to install the dependent modules, which can be done via NPM package manager. From the terminal’s command line, **type this command:**

        npm install

The main packages our application depends on are: raspicam, opencv, twilio-sync, twilio-mcs-client. Allow it a bit of time to download the packages and build the OpenCV wrapper.

4. The script also needs a place to save the photos it takes. Create one by adding a directory in the same place you copied the security-camera.js script.

        mkdir /home/pi/camera/images

5. Ensure that the path where you added your images folder matches the path on line 14 in the security-camera.js script.
6. Update the server info in the security-camera.js script
  - Change the clientBootstrapUrl variable on line 13 to the URL where your CameraAuthenticator function is deployed.
7. Update the camera info in the security-camera.js script with the values from the camera registration on the server.
  - Change the cameraId variable on line 11 to the ID you used when adding the camera (on step 10).
  - Change the cameraSecret variable on line 12 to the token generated by the server application (on step 10).
8. To run our script, you just need to **run these commands from the command line**:

      cd /home/pi/camera
      npm start

### Configure the Pi to run the script at start-up. (optional)

You can manually run the script every time you want to use the camera, so we are going to configure the Raspberry Pi Zero to run the script at start-up.

To do this, we need to add a line to the file **rc.local** on the Pi, which runs on startup, located in /etc/rc.local.

* From the command line, **type this to edit rc.local:**

      sudo nano /etc/rc.local

Add this line right before it reads ‘exit 0’:

    node /home/pi/camera/security-camera.js

rc.local will look like the following:

    #!/bin/sh -e
    #
    # rc.local
    #
    # This script is executed at the end of each multiuser runlevel.
    # Make sure that the script will "exit 0" on success or any other
    # value on error.
    #
    # In order to enable or disable this script just change the execution
    # bits.
    #
    # By default this script does nothing.
    # Print the IP address
    _IP=$(hostname -I) || true
    if [ "$_IP" ]; then
    printf "My IP address is %s\n" "$_IP"
    fi
    node /home/pi/camera/security-camera.js
    exit 0

* **Save and exit the file editor**.
* The script is set up and should run on start-up and can be run directly via the command line.
